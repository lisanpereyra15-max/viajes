<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrasLaDar - Gesti贸n de Viajes</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --celeste: #82caff; 
            --whatsapp: #25d366; 
            --oscuro: #333; 
            --blanco: #fff;
        }
        body { margin: 0; font-family: 'Poppins', sans-serif; background-color: var(--celeste); display: flex; flex-direction: column; align-items: center; }
        .header-banner { width: 100%; height: 180px; background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('https://images.unsplash.com/photo-1449965408869-eaa3f722e40d?q=80&w=2070&auto=format&fit=crop'); background-size: cover; background-position: center; display: flex; justify-content: center; align-items: center; }
        .logo-img { max-width: 140px; background: white; padding: 10px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .container { max-width: 800px; width: 90%; margin-top: -30px; margin-bottom: 50px; }
        .main-card { background: var(--blanco); padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
        h2 { text-align: center; margin: 0 0 20px 0; font-size: 1.3rem; }
        .grid-form { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .input-group { display: flex; flex-direction: column; }
        label { font-size: 0.7rem; font-weight: 700; margin-bottom: 5px; color: #777; text-transform: uppercase; }
        select, input { padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 1rem; outline: none; }
        .input-full { grid-column: 1 / -1; }
        #vehiculo { border: 2px solid var(--celeste); background-color: #f0f9ff; }
        .services-mix { background: #f8f9fa; padding: 15px; border-radius: 15px; margin-bottom: 20px; display: flex; justify-content: space-around; flex-wrap: wrap; gap: 10px; }
        .service-option { text-align: center; }
        .service-option input { width: 50px; text-align: center; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
        .btn-ws { width: 100%; background-color: var(--whatsapp); color: white; border: none; padding: 18px; border-radius: 12px; font-weight: 600; font-size: 1rem; cursor: pointer; transition: 0.3s; box-shadow: 0 5px 15px rgba(37,211,102,0.2); }
        .btn-ws:disabled { background-color: #ccc; cursor: not-allowed; }
        .footer-info { text-align: center; color: white; margin-top: 15px; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div class="header-banner"><img src="logo.jpg" alt="Logo" class="logo-img"></div>

    <div class="container">
        <div class="main-card">
            <h2>Gesti贸n de Viajes TrasLaDar</h2>
            <form id="formViaje">
                <div class="grid-form">
                    <div class="input-group"><label>Origen</label>
                        <select id="origen"><option value="C贸rdoba">C贸rdoba</option><option value="R铆o Cuarto">R铆o Cuarto</option></select>
                    </div>
                    <div class="input-group"><label>Destino</label>
                        <select id="destino"><option value="R铆o Cuarto">R铆o Cuarto</option><option value="C贸rdoba">C贸rdoba</option></select>
                    </div>
                    <div class="input-group"><label>Fecha</label><input type="date" id="fecha"></div>
                    <div class="input-group input-full"><label>Veh铆culo / Chofer</label><input type="text" id="vehiculo" placeholder="Ej: Sprinter Blanca - Juan" required></div>
                </div>

                <div class="services-mix">
                    <div class="service-option"><label> Pasajeros</label><br><input type="number" id="p" value="1" min="0"></div>
                    <div class="service-option"><label> Encomiendas</label><br><input type="number" id="e" value="0" min="0"></div>
                    <div class="service-option"><label> Mascotas</label><br><input type="number" id="m" value="0" min="0"></div>
                </div>

                <button type="button" id="submitBtn" onclick="procesar()" class="btn-ws">Registrar Viaje en Excel</button>
            </form>
        </div>
        <div class="footer-info">Sistema de Gesti贸n Interna - Lisandro</div>
    </div>

    <script>
        // Setear fecha m铆nima hoy
        document.getElementById('fecha').setAttribute('min', new Date().toISOString().split('T')[0]);

        async function procesar() {
            const btn = document.getElementById('submitBtn');
            // Tu URL de Google Script ya integrada
            const urlExcel = "https://script.google.com/macros/s/AKfycby1FXaI82VYs26X8iSYBdkqDtpol6eVFomxeVDc7chC7CFuIkygeiRBRkhP24-Ygola/exec"; 
            
            const datos = {
                fecha: document.getElementById('fecha').value,
                origen: document.getElementById('origen').value,
                destino: document.getElementById('destino').value,
                vehiculo: document.getElementById('vehiculo').value,
                pasajeros: document.getElementById('p').value,
                encomiendas: document.getElementById('e').value,
                mascotas: document.getElementById('m').value
            };

            if (!datos.fecha || !datos.vehiculo) {
                alert("Por favor, completa la Fecha y el Veh铆culo.");
                return;
            }

            btn.disabled = true;
            btn.innerText = "Guardando en Excel...";

            try {
                // Env铆o de datos al Google Sheets
                await fetch(urlExcel, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify(datos)
                });
                
                // Formatear mensaje para WhatsApp
                let f = datos.fecha.split("-");
                let fechaOk = `${f[2]}/${f[1]}/${f[0]}`;
                let msj = `*NUEVO REGISTRO EN EXCEL*\n\n *Fecha:* ${fechaOk}\n *Ruta:* ${datos.origen} -> ${datos.destino}\n *Veh铆culo:* ${datos.vehiculo}\n\n*Detalle:* \n- Pasajeros: ${datos.pasajeros}\n- Encomiendas: ${datos.encomiendas}\n- Mascotas: ${datos.mascotas}`;
                
                // Abrir WhatsApp y avisar 茅xito
                window.open(`https://wa.me/5493512832957?text=${encodeURIComponent(msj)}`, '_blank');
                alert("隆Datos guardados con 茅xito en la planilla!");
                
            } catch (err) {
                console.error(err);
                alert("Error al conectar con el servidor. Revisa tu conexi贸n.");
            } finally {
                btn.disabled = false;
                btn.innerText = "Registrar Viaje en Excel";
            }
        }
    </script>
</body>
</html>